# 家庭用ストック管理アプリ 仕様書

## 1. アプリケーション概要
「家にあれあったっけ？」を解消するための、個体数ベースの在庫管理・購入履歴記録アプリです。

## 2. コアコンセプト
- **個体カウント**: 重さ（g）や量（ml）ではなく、本数や個数（ボトル、パック）を最小単位として管理します。
- **柔軟なメモ**: 同じ商品でもサイズが異なる場合は、商品マスタを分けずに購入時の「容量・メモ」で記録することで管理を簡略化します。
- **入力の簡素化**: 買い物は1件ずつサクッと登録し、単価入力のストレス（初期値0の削除など）を排除しています。

## 3. 主要機能

### 3.1 在庫管理 (Dashboard)
- **一覧表示**: 登録されている全商品の現在の在庫数（個/つ）を表示します。
- **クイック調整**: 「+1」「-1」ボタンにより、買い物を通さずとも手軽に在庫数を修正可能です。

### 3.2 買い物登録 (Purchase Log)
- **単一登録**: 一度の操作で1つの商品の購入を記録します。
- **入力項目**:
    - 購入日（デフォルトは今日）
    - お店（登録済みリストから選択）
    - 商品名（登録済みリストから選択）
    - 購入個数（何本、何パック買ったか）
    - **容量・メモ**: 「100ml」「詰め替え」「3本パック」など自由に記載。
    - 単価: 1つあたりの金額。
- **連動**: 登録完了と同時に、在庫数が「購入個数」分だけ加算されます。

### 3.3 商品管理 (Master Data)
- **商品登録**: 「商品名」と「カテゴリ」のみのシンプル構成です。
- **カテゴリ**: キッチン、お風呂、掃除、パントリー、日用品。
- **商品詳細**:
    - 過去の購入履歴を時系列で表示します。
    - どのお店で、いつ、どのようなサイズ（容量・メモ）をいくらで買ったかを確認可能です。
- **削除機能**: 不要になった商品を関連データ（履歴・在庫）含めて一括削除可能です。

### 3.4 お店管理
- **店名登録**: 店名のみのシンプル管理です。
- **スマホ対応**: 画面下部のナビゲーションから「お店」一覧へアクセスし、追加・確認が可能です。

## 4. 技術スタック
- **Frontend**: Next.js 15 (App Router)
- **Styling**: Tailwind CSS, Shadcn/UI
- **Backend/Database**: Supabase (PostgreSQL)
- **Testing**: Vitest

## 5. データ構造 (Supabase)
- `products`: 商品基本情報
- `stores`: 店舗情報
- `purchases`: 購入イベントのヘッダー
- `purchase_lines`: 購入明細（`size_info` カラムに容量メモを保持）
- `stock`: 在庫スナップショット
- `stock_adjustments`: 手動調整履歴

## 6. 運用ガイド
同じ「洗剤」でも、ボトル（1つ）と詰め替え（1つ）を在庫上は同じ「1」としてカウントする運用を推奨します。価格の比較は、詳細画面の履歴に表示される「容量メモ」を参照して判断します。
